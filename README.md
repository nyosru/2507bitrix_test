# как запускать
Сборка представляет собой связку:
docker + nginx + php-fpm + mysql + memcached

   + в териминале: заходите в папу куда положим файлы тест проекта
   + в териминале: клонируете к себе репозиторий 
     + ``git clone https://github.com/nyosru/2507bitrix_test.git``
   + копируем файл ``/.env.example`` в ``/.env`` 
     + ``cp .env.example .env`` 
   + в териминале: запускам сборку  ``docker-compose up``
   + начинайте кликать всякое в админке: https://localhost/bitrix/admin/
      + логин ``admin`` пароль ``123123123``
   + Marketplace > Установленные решения
     + установлен модуль phpcatcom ТестБлок
       + (удалите и установите) если он уже установлен
     + в Сервисы смотрите 
       + Курсы валют (список)
       + Курсы валют (добавление)

## Тестовое задание для PHP-программиста (Битрикс)

Пояснения и дополнения:

● Тестовое задание выполнять в демо-версии «1С-Битрикс «Управление сайтом» редакции Старт

++ готово

● Использовать последнюю стабильную на данный момент версию CMS и совместимую с ней последнюю версию PHP

++ готово

● Результат оформить в виде набора компонентов/модулей отдельно или в составе CMS целиком, 
залить в любой общедоступный репозиторий (github, gitlab, bitbucket)

++ готово

● Использовать возможности ядра D7 и новый синтаксис, папку local, ORM

++ папка local / готово


● Модуль должен корректно устанавливаться/удаляться как из папки bitrix/modules, так и из папки local/modules.

++ готово

## Задание

### Написать модуль для битрикса, который будет добавлять новую сущность - курсы валют.

1. Создать скелет для модуля на битрикса согласно инструкции https://dev.1c-bitrix.ru/learning/course/?COURSE_ID=43&INDEX=Y

++ готово

2. Модуль должен при установке создавать таблицу в бд вида: 

   + id (primary key) | 
   + code (код валюты, например, USD или EUR, string) | 
   + date (datetime) | 
   + course (float)
   + , а при удалении удалять эту таблицу. 
   + Пример можно найти в модуле инфоблоков: bitrix/modules/iblock/install/index.php


++ готово

3. Для таблицы из п.2 должна быть создана ORM сущность https://dev.1c-bitrix.ru/learning/course/?COURSE_ID=43&CHAPTER_ID=05748

++ готово, такой вариант норм ?

4. При установке модуль должен устанавливать 
два компонента: фильтр курсов 
и список курсов валют 
- а при удалении удалять эти два компонента.

5. Список валют должен иметь возможность для подключения фильтра и выбора колонок для вывода, 
должен иметь настраиваемую постраничную навигацию.
- добавил страницу где видим все курсы валют (+редактировать) и форму для добавления (добавить курс валют)  
- (использую ОРМ)
- для списка и постраничной навигации использую битрикс компонент bitrix:main.ui.grid
- постраничная навигация

6. Фильтр должен позволять выводить форму для фильтрации 
по дате (от и до), курсу (от и до), коду валюты.
- добавлены сортировки по дате курсу и валюте

7. Модуль не должен использовать сторонние решения, 
за исключением тех функций, что предоставляет главный модуль (main) битрикса.
- ок, использую только внутренние штуки битрикса


## дела и мысли по мере реализации задания

1. какой-то косяк с JS в админке .. пришлось обойтись GET запросом для удаления записи
2. добавил таблицу с фильтрами, сортировками и постраничной навигацией в публичную часть сайта (посмотреть как будет работать JS)
   - добавил дополнительный вид модуля для публичной части ``www/local/modules/phpcatcom.testmodule/admin/phpcatcom_testmodule_list_public.php``
     - идёт копирование кода, лучше наверное вынести среднюю часть в отдельный файл и его подгружать в админке и в публичном сайте (надо обсудить, делают так или нет)
   - ссылка на сайте ``Курсы валют`` > https://localhost/currency/ 
3. добавлять пункт меню в публичную часть сайта лучше руками, так как автоматизированный способ не подготовлен удобно ( с защитой от дублирования и избегание дополнительных сложностей с разными шаблонами)
   - тут (на публичном сайте) JS работает хорошо, похоже в админке просто нет каких-то JS библиотек 
4. добавил в элемент меню условие .. если модуль удалён то ссылку не видно, если поставили опять, то видно
    - ``IsModuleInstalled('phpcatcom.testmodule')``