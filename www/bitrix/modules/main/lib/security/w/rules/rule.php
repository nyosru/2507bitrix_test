<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____874920545']= array(base64_decode('aX'.'Nf'.'c3RyaW'.'5n'),base64_decode('c3R'.'y'.'d'.'G9sb3dlcg=='),base64_decode('aXNfYXJ'.'y'.'YXk='),base64_decode('aXNfc3'.'RyaW5n'),base64_decode('Z'.'3p'.'kZWNv'.'ZGU='),base64_decode(''.'YmF'.'zZT'.'Y0'.'X2'.'RlY29kZQ='.'='),base64_decode('dXJ'.'sZ'.'GV'.'jb2Rl'),base64_decode('YX'.'J'.'y'.'YXlfcmV2ZXJ'.'zZQ=='),base64_decode(''.'Z3plbmNvZGU='),base64_decode(''.'YmFzZTY0X2VuY2'.'9kZQ='.'='),base64_decode(''.'dXJsZW5jb2R'.'l'),base64_decode('YmluMmh'.'leA=='),base64_decode(''.'aXN'.'fYXJyYXk='),base64_decode('c3'.'RydG9sb3dlcg=='),base64_decode('aX'.'NfY'.'XJy'.'Y'.'X'.'k='),base64_decode('am9pbg=='),base64_decode(''.'Zm5'.'tYXRjaA=='),base64_decode('cmF3dXJsZ'.'G'.'V'.'jb2Rl'),base64_decode(''.'c3Vic'.'3'.'R'.'y'),base64_decode('c3V'.'ic3Ry'),base64_decode('c3R'.'y'.'X3J'.'l'.'cGxh'.'Y2U='),base64_decode('cHJ'.'lZ19'.'xdW90ZQ'.'=='),base64_decode('cHJlZ19tYXR'.'jaA=='));if(!function_exists(__NAMESPACE__.'\\___1890007591')){function ___1890007591($_748514012){static $_673398196= false; if($_673398196 == false) $_673398196=array(''.'YWN0aW9u',''.'aW50d'.'mFs','cGF0aA==',''.'Y29'.'ud'.'GV4d'.'A==','a2V5cw==','c'.'HJvY2'.'Vzc'.'w'.'==','ZW5j'.'b2Rp'.'bmc=','cH'.'Jl'.'Z1'.'9yZXBsYWN'.'l','cGF0aA==','Y2'.'9u'.'dGV4dA==','a2V5cw==','cHJv'.'Y2Vzcw==','ZW5jb2Rpbm'.'c=','cGF0dGVybg'.'='.'=','cH'.'JlZ19tYXRja'.'A='.'=','c'.'G'.'F'.'0aA==','Y29udG'.'V4dA'.'='.'=','a2V'.'5cw==',''.'cHJv'.'Y2Vzcw==','Z'.'W5jb'.'2Rpb'.'mc=','cGF0d'.'GVybg==','cG'.'9'.'zdF'.'9'.'hY3Rpb24=','Y2hlY2tfY'.'3NyZ'.'g='.'=','cGF'.'0a'.'A'.'==','Y29udGV'.'4dA==',''.'a2'.'V'.'5cw==','cHJ'.'vY2'.'Vz'.'cw='.'=','ZW5j'.'b2'.'Rpbmc=','cGF'.'0dGVy'.'bg==','YWN0aW9u','YWN0a'.'W9u',''.'Y'.'WN0a'.'W'.'9u','YWN0aW9u','YWN0aW9u','Y'.'WN0aW9u','cG'.'9zdF9h'.'Y3Rpb'.'24=','ZW5j'.'b2Rpbmc=','ZW'.'5'.'jb2Rpbmc=','ZW5jb2Rpbmc=','ZW5jb2Rpbmc=',''.'ZW5jb2Rpbmc=','Z'.'W5j'.'b2'.'Rpb'.'mc=',''.'Z3o=','YmFzZT'.'Y0','dX'.'Js','aG'.'V4','L'.'g'.'==','L'.'w'.'='.'=',''.'aW'.'5kZXg'.'ucGh'.'w','L2luZG'.'V4LnBocA='.'=','U0NSSV'.'BUX0'.'5BT'.'UU=','L'.'2lu'.'ZGV4LnBocA==','U0N'.'S'.'SV'.'BU'.'X05B'.'TUU'.'=','U0NSSVBUX05BTUU=','U'.'0NSSVBU'.'X0'.'5BTUU=','fg==',''.'fl4=','fg'.'==','X'.'H4=','JH'.'4=');return base64_decode($_673398196[$_748514012]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_539101074; protected $_2068093949; protected $_971678855; protected $_730529285; protected $_646752657; public static function make(array $_2021702344):?static{ $_2021702344= static::prepareRuleParameters($_2021702344); return match($_2021702344[___1890007591(0)]){ ___1890007591(1) => new IntvalRule( $_2021702344[___1890007591(2)], $_2021702344[___1890007591(3)], $_2021702344[___1890007591(4)], $_2021702344[___1890007591(5)], $_2021702344[___1890007591(6)]), ___1890007591(7) => new PregReplaceRule( $_2021702344[___1890007591(8)], $_2021702344[___1890007591(9)], $_2021702344[___1890007591(10)], $_2021702344[___1890007591(11)], $_2021702344[___1890007591(12)], $_2021702344[___1890007591(13)]), ___1890007591(14) => new PregMatchRule( $_2021702344[___1890007591(15)], $_2021702344[___1890007591(16)], $_2021702344[___1890007591(17)], $_2021702344[___1890007591(18)], $_2021702344[___1890007591(19)], $_2021702344[___1890007591(20)], $_2021702344[___1890007591(21)]), ___1890007591(22) => new CsrfRule( $_2021702344[___1890007591(23)], $_2021702344[___1890007591(24)], $_2021702344[___1890007591(25)], $_2021702344[___1890007591(26)], $_2021702344[___1890007591(27)], $_2021702344[___1890007591(28)],), default => null,};} protected static function prepareRuleParameters(array $_232997934): array{ if($GLOBALS['____874920545'][0]($_232997934[___1890007591(29)])){ $_232997934[___1890007591(30)]= $GLOBALS['____874920545'][1]($_232997934[___1890007591(31)]);} elseif($GLOBALS['____874920545'][2]($_232997934[___1890007591(32)])){ $_1567492087= $_232997934[___1890007591(33)]; $_232997934[___1890007591(34)]= $_1567492087[min(206,0,68.666666666667)]; $_232997934[___1890007591(35)]= $_1567492087[round(0+0.5+0.5)];} $_232997934[___1890007591(36)]=!empty($_232997934[___1890007591(37)])? $_232997934[___1890007591(38)]:[]; if($GLOBALS['____874920545'][3]($_232997934[___1890007591(39)])){ $_232997934[___1890007591(40)]=[$_232997934[___1890007591(41)]];} return $_232997934;}  public function __construct($_539101074, $_2068093949, $_971678855, $_730529285, $_646752657){ $this->_539101074= $_539101074; $this->_2068093949= $this->castContext($_2068093949); $this->_971678855= $this->castKeys($_971678855); $this->_730529285= $_730529285; $this->_646752657= $_646752657;} public function evaluateValue($_275030782){ if(!empty($this->_646752657)){ foreach($this->_646752657 as $_801003940){ $_275030782= match($_801003940){ 'gz' => $GLOBALS['____874920545'][4]($_275030782), 'base64' => $GLOBALS['____874920545'][5]($_275030782), 'url' => $GLOBALS['____874920545'][6]($_275030782), 'hex' => hex2bin($_275030782)};}} $_579120608= $this->evaluate($_275030782); if(!empty($this->_646752657) && $_579120608 instanceof ModifyResult){ $_298019369= $_579120608->getCleanValue(); foreach($GLOBALS['____874920545'][7]($this->_646752657) as $_801003940){ $_298019369= match($_801003940){ ___1890007591(42) => $GLOBALS['____874920545'][8]($_298019369), ___1890007591(43) => $GLOBALS['____874920545'][9]($_298019369), ___1890007591(44) => $GLOBALS['____874920545'][10]($_298019369), ___1890007591(45) => $GLOBALS['____874920545'][11]($_298019369)};} $_579120608= new ModifyResult($_298019369);} return $_579120608;} abstract public function evaluate($_275030782); protected function castContext($_2068093949){ if(!$GLOBALS['____874920545'][12]($_2068093949)){ $_2068093949=[$_2068093949];} foreach($_2068093949 as $_1167493848 => $_211674392){ $_2068093949[$_1167493848]= $GLOBALS['____874920545'][13]($_211674392);} return $_2068093949;} protected function castKeys($_971678855){ if(!$GLOBALS['____874920545'][14]($_971678855)){ $_971678855=[$_971678855];} return $_971678855;} public function matchKey(array $_2098007114): bool{ $_2098007114= $GLOBALS['____874920545'][15](___1890007591(46), $_2098007114); foreach($this->_971678855 as $_1364086145){   if($GLOBALS['____874920545'][16]($_1364086145, $_2098007114)){ return true;}} return false;}  public function matchPath($_325302552){ if($this->_539101074 === '*'){ return true;}  $_73160111= new Uri($_325302552); $_1843234690= $_73160111->getPath(); $_1843234690= $GLOBALS['____874920545'][17]($_1843234690);      if(str_ends_with($_1843234690, ___1890007591(47))){ $_1843234690 .= ___1890007591(48);} $_1843234690= Path::normalize($_1843234690);  $_1567041081[]= $_1843234690; if(str_ends_with($_1843234690, ___1890007591(49))){ $_1567041081[]= $GLOBALS['____874920545'][18]($_1843234690,(208*2-416),-round(0+2.25+2.25+2.25+2.25));} elseif(str_ends_with($_SERVER[___1890007591(50)], ___1890007591(51))){ $_1567041081[]= $GLOBALS['____874920545'][19]($_SERVER[___1890007591(52)],(836-2*418),-round(0+2.25+2.25+2.25+2.25));} if($_1843234690 !== $_SERVER[___1890007591(53)]){ $_1567041081[]= $_SERVER[___1890007591(54)];}  if(str_starts_with($this->_539101074, ___1890007591(55))){ $_3158308= $this->_539101074;} else{ $_3158308= ___1890007591(56). $GLOBALS['____874920545'][20](___1890007591(57), ___1890007591(58), $GLOBALS['____874920545'][21]($this->_539101074)). ___1890007591(59);} foreach($_1567041081 as $_1136837255){ if($this->_539101074 === $_1136837255 || $GLOBALS['____874920545'][22]($_3158308, $_1136837255)){ return true;}} return false;}  public function getPath(){ return $this->_539101074;}  public function getContext(){ return $this->_2068093949;}  public function getKeys(){ return $this->_971678855;}  public function getProcess(){ return $this->_730529285;}}?>